import{_ as Xn,f as jn,c as D,o as W,a as qn,A as J,l as ln,B as Fn,x as Z,b as cn,C as vn,D as Gn,E as Un,G as fn,H as Yn,h as B,r as un,I as Ln,s as Mn,J as kn,K as V,L as X,M as $n,N as Hn}from"./BEMtwttk.js";import{u as Dn}from"./Dg19p0Ij.js";import{j as Wn,k as Bn,m as Jn,n as Kn,o as Pn}from"./uzHwbF_c.js";const A=Gn(X.ui.strategy,X.ui.input,$n),Qn=jn({components:{UIcon:vn},inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>A.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(n){return Object.keys(A.size).includes(n)}},color:{type:String,default:()=>A.default.color,validator(n){return[...X.ui.colors,...Object.keys(A.color)].includes(n)}},variant:{type:String,default:()=>A.default.variant,validator(n){return[...Object.keys(A.variant),...Object.values(A.color).flatMap(e=>Object.keys(e))].includes(n)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(n,{emit:e,slots:s}){const{ui:t,attrs:i}=Un("input",fn(n,"ui"),A,fn(n,"class")),{size:a,rounded:r}=Yn({ui:t,props:n}),{emitFormBlur:l,emitFormInput:c,size:u,color:f,inputId:g,name:y}=Dn(n,A),d=B(()=>a.value??u.value),m=un(Ln({},n.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),I=un(null),S=()=>{n.autofocus&&I.value?.focus()},z=p=>{m.value.trim&&(p=p.trim()),(m.value.number||n.type==="number")&&(p=Hn(p)),m.value.nullify&&(p||=null),e("update:modelValue",p),c()},q=p=>{m.value.lazy||z(p.target.value)},F=p=>{if(n.type==="file"){const R=p.target.files;e("change",R)}else{const R=p.target.value;e("change",R),m.value.lazy&&z(R),m.value.trim&&(p.target.value=R.trim())}},$=p=>{l(),e("blur",p)};Mn(()=>{setTimeout(()=>{S()},n.autofocusDelay)});const H=B(()=>{const p=t.value.color?.[f.value]?.[n.variant]||t.value.variant[n.variant];return kn(V(t.value.base,t.value.form,r.value,t.value.placeholder,n.type==="file"&&t.value.file.base,t.value.size[d.value],n.padded?t.value.padding[d.value]:"p-0",p?.replaceAll("{color}",f.value),(T.value||s.leading)&&t.value.leading.padding[d.value],(G.value||s.trailing)&&t.value.trailing.padding[d.value]),n.inputClass)}),T=B(()=>n.icon&&n.leading||n.icon&&!n.trailing||n.loading&&!n.trailing||n.leadingIcon),G=B(()=>n.icon&&n.trailing||n.loading&&n.trailing||n.trailingIcon),xn=B(()=>n.loading?n.loadingIcon:n.leadingIcon||n.icon),Tn=B(()=>n.loading&&!T.value?n.loadingIcon:n.trailingIcon||n.icon),On=B(()=>V(t.value.icon.leading.wrapper,t.value.icon.leading.pointer,t.value.icon.leading.padding[d.value])),Rn=B(()=>V(t.value.icon.base,f.value&&X.ui.colors.includes(f.value)&&t.value.icon.color.replaceAll("{color}",f.value),t.value.icon.size[d.value],n.loading&&t.value.icon.loading)),Zn=B(()=>V(t.value.icon.trailing.wrapper,t.value.icon.trailing.pointer,t.value.icon.trailing.padding[d.value])),Vn=B(()=>V(t.value.icon.base,f.value&&X.ui.colors.includes(f.value)&&t.value.icon.color.replaceAll("{color}",f.value),t.value.icon.size[d.value],n.loading&&!T.value&&t.value.icon.loading));return{ui:t,attrs:i,name:y,inputId:g,input:I,isLeading:T,isTrailing:G,inputClass:H,leadingIconName:xn,leadingIconClass:Rn,leadingWrapperIconClass:On,trailingIconName:Tn,trailingIconClass:Vn,trailingWrapperIconClass:Zn,onInput:q,onChange:F,onBlur:$}}}),_n=["id","name","type","required","placeholder","disabled"];function ne(n,e,s,t,i,a){const r=vn;return W(),D("div",{class:Z(n.type==="hidden"?"hidden":n.ui.wrapper)},[qn("input",Fn({id:n.inputId,ref:"input",name:n.name,type:n.type,required:n.required,placeholder:n.placeholder,disabled:n.disabled,class:n.inputClass},n.type==="file"?n.attrs:{...n.attrs,value:n.modelValue},{onInput:e[0]||(e[0]=(...l)=>n.onInput&&n.onInput(...l)),onBlur:e[1]||(e[1]=(...l)=>n.onBlur&&n.onBlur(...l)),onChange:e[2]||(e[2]=(...l)=>n.onChange&&n.onChange(...l))}),null,16,_n),J(n.$slots,"default"),n.isLeading&&n.leadingIconName||n.$slots.leading?(W(),D("span",{key:0,class:Z(n.leadingWrapperIconClass)},[J(n.$slots,"leading",{disabled:n.disabled,loading:n.loading},()=>[cn(r,{name:n.leadingIconName,class:Z(n.leadingIconClass)},null,8,["name","class"])])],2)):ln("",!0),n.isTrailing&&n.trailingIconName||n.$slots.trailing?(W(),D("span",{key:1,class:Z(n.trailingWrapperIconClass)},[J(n.$slots,"trailing",{disabled:n.disabled,loading:n.loading},()=>[cn(r,{name:n.trailingIconName,class:Z(n.trailingIconClass)},null,8,["name","class"])])],2)):ln("",!0)],2)}const we=Object.assign(Xn(Qn,[["render",ne]]),{__name:"UInput"});const ee={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:b,n:U,Gx:dn,Gy:gn,a:K,d:P}=ee,te=8n,j=32,en=64,v=(n="")=>{throw new Error(n)},se=n=>typeof n=="bigint",wn=n=>typeof n=="string",oe=n=>n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array",N=(n,e)=>!oe(n)||typeof e=="number"&&e>0&&n.length!==e?v("Uint8Array expected"):n,k=n=>new Uint8Array(n),tn=n=>Uint8Array.from(n),In=(n,e)=>n.toString(16).padStart(e,"0"),sn=n=>Array.from(N(n)).map(e=>In(e,2)).join(""),C={_0:48,_9:57,A:65,F:70,a:97,f:102},yn=n=>{if(n>=C._0&&n<=C._9)return n-C._0;if(n>=C.A&&n<=C.F)return n-(C.A-10);if(n>=C.a&&n<=C.f)return n-(C.a-10)},on=n=>{const e="hex invalid";if(!wn(n))return v(e);const s=n.length,t=s/2;if(s%2)return v(e);const i=k(t);for(let a=0,r=0;a<t;a++,r+=2){const l=yn(n.charCodeAt(r)),c=yn(n.charCodeAt(r+1));if(l===void 0||c===void 0)return v(e);i[a]=l*16+c}return i},an=(n,e)=>N(wn(n)?on(n):tn(N(n)),e),An=()=>globalThis?.crypto,ae=()=>An()?.subtle??v("crypto.subtle must be defined"),Y=(...n)=>{const e=k(n.reduce((t,i)=>t+N(i).length,0));let s=0;return n.forEach(t=>{e.set(t,s),s+=t.length}),e},ie=(n=j)=>An().getRandomValues(k(n)),L=BigInt,E=(n,e,s,t="bad number: out of range")=>se(n)&&e<=n&&n<s?n:v(t),o=(n,e=b)=>{const s=n%e;return s>=0n?s:e+s},Cn=n=>o(n,U),Sn=(n,e)=>{(n===0n||e<=0n)&&v("no inverse n="+n+" mod="+e);let s=o(n,e),t=e,i=0n,a=1n;for(;s!==0n;){const r=t/s,l=t%s,c=i-a*r;t=s,s=l,i=a,a=c}return t===1n?o(i,e):v("no inverse")},mn=n=>n instanceof h?n:v("Point expected"),Q=2n**256n;class h{static BASE;static ZERO;ex;ey;ez;et;constructor(e,s,t,i){const a=Q;this.ex=E(e,0n,a),this.ey=E(s,0n,a),this.ez=E(t,1n,a),this.et=E(i,0n,a),Object.freeze(this)}static fromAffine(e){return new h(e.x,e.y,1n,o(e.x*e.y))}static fromBytes(e,s=!1){const t=P,i=tn(N(e,j)),a=e[31];i[31]=a&-129;const r=En(i);E(r,0n,s?Q:b);const c=o(r*r),u=o(c-1n),f=o(t*c+1n);let{isValid:g,value:y}=le(u,f);g||v("bad point: y not sqrt");const d=(y&1n)===1n,m=(a&128)!==0;return!s&&y===0n&&m&&v("bad point: x==0, isLastByteOdd"),m!==d&&(y=o(-y)),new h(y,r,1n,o(y*r))}assertValidity(){const e=K,s=P,t=this;if(t.is0())throw new Error("bad point: ZERO");const{ex:i,ey:a,ez:r,et:l}=t,c=o(i*i),u=o(a*a),f=o(r*r),g=o(f*f),y=o(c*e),d=o(f*o(y+u)),m=o(g+o(s*o(c*u)));if(d!==m)throw new Error("bad point: equation left != right (1)");const I=o(i*a),S=o(r*l);if(I!==S)throw new Error("bad point: equation left != right (2)");return this}equals(e){const{ex:s,ey:t,ez:i}=this,{ex:a,ey:r,ez:l}=mn(e),c=o(s*l),u=o(a*i),f=o(t*l),g=o(r*i);return c===u&&f===g}is0(){return this.equals(O)}negate(){return new h(o(-this.ex),this.ey,this.ez,o(-this.et))}double(){const{ex:e,ey:s,ez:t}=this,i=K,a=o(e*e),r=o(s*s),l=o(2n*o(t*t)),c=o(i*a),u=e+s,f=o(o(u*u)-a-r),g=c+r,y=g-l,d=c-r,m=o(f*y),I=o(g*d),S=o(f*d),z=o(y*g);return new h(m,I,z,S)}add(e){const{ex:s,ey:t,ez:i,et:a}=this,{ex:r,ey:l,ez:c,et:u}=mn(e),f=K,g=P,y=o(s*r),d=o(t*l),m=o(a*g*u),I=o(i*c),S=o((s+t)*(r+l)-y-d),z=o(I-m),q=o(I+m),F=o(d-f*y),$=o(S*z),H=o(q*F),T=o(S*F),G=o(z*q);return new h($,H,G,T)}multiply(e,s=!0){if(!s&&(e===0n||this.is0()))return O;if(E(e,1n,U),e===1n)return this;if(this.equals(x))return be(e).p;let t=O,i=x;for(let a=this;e>0n;a=a.double(),e>>=1n)e&1n?t=t.add(a):s&&(i=i.add(a));return t}toAffine(){const{ex:e,ey:s,ez:t}=this;if(this.equals(O))return{x:0n,y:1n};const i=Sn(t,b);return o(t*i)!==1n&&v("invalid inverse"),{x:o(e*i),y:o(s*i)}}toBytes(){const{x:e,y:s}=this.assertValidity().toAffine(),t=zn(s);return t[31]|=e&1n?128:0,t}toHex(){return sn(this.toBytes())}clearCofactor(){return this.multiply(L(te),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let e=this.multiply(U/2n,!1).double();return U%2n&&(e=e.add(this)),e.is0()}static fromHex(e,s){return h.fromBytes(an(e),s)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(){return this.toBytes()}}const x=new h(dn,gn,1n,o(dn*gn)),O=new h(0n,1n,1n,0n);h.BASE=x;h.ZERO=O;const zn=n=>on(In(E(n,0n,Q),en)).reverse(),En=n=>L("0x"+sn(tn(N(n)).reverse())),w=(n,e)=>{let s=n;for(;e-- >0n;)s*=s,s%=b;return s},re=n=>{const s=n*n%b*n%b,t=w(s,2n)*s%b,i=w(t,1n)*n%b,a=w(i,5n)*i%b,r=w(a,10n)*a%b,l=w(r,20n)*r%b,c=w(l,40n)*l%b,u=w(c,80n)*c%b,f=w(u,80n)*c%b,g=w(f,10n)*a%b;return{pow_p_5_8:w(g,2n)*n%b,b2:s}},pn=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,le=(n,e)=>{const s=o(e*e*e),t=o(s*s*e),i=re(n*t).pow_p_5_8;let a=o(n*s*i);const r=o(e*a*a),l=a,c=o(a*pn),u=r===n,f=r===o(-n),g=r===o(-n*pn);return u&&(a=l),(f||g)&&(a=c),(o(a)&1n)===1n&&(a=o(-a)),{isValid:u||f,value:a}},_=n=>Cn(En(n)),rn=(...n)=>ye.sha512Async(...n),ce=n=>{const e=n.slice(0,j);e[0]&=248,e[31]&=127,e[31]|=64;const s=n.slice(j,en),t=_(e),i=x.multiply(t),a=i.toBytes();return{head:e,prefix:s,scalar:t,point:i,pointBytes:a}},fe=n=>rn(an(n,j)).then(ce),ue=n=>rn(n.hashable).then(n.finish),de=(n,e,s)=>{const{pointBytes:t,scalar:i}=n,a=_(e),r=x.multiply(a).toBytes();return{hashable:Y(r,t,s),finish:u=>{const f=Cn(a+_(u)*i);return N(Y(r,zn(f)),en)}}},ge=async(n,e)=>{const s=an(n),t=await fe(e),i=await rn(t.prefix,s);return ue(de(t,i,s))},ye={sha512Async:async(...n)=>{const e=ae(),s=Y(...n);return k(await e.digest("SHA-512",s.buffer))},sha512Sync:void 0,bytesToHex:sn,hexToBytes:on,concatBytes:Y,mod:o,invert:Sn,randomBytes:ie},M=8,me=256,Nn=Math.ceil(me/M)+1,nn=2**(M-1),pe=()=>{const n=[];let e=x,s=e;for(let t=0;t<Nn;t++){s=e,n.push(s);for(let i=1;i<nn;i++)s=s.add(e),n.push(s);e=s.double()}return n};let bn;const hn=(n,e)=>{const s=e.negate();return n?s:e},be=n=>{const e=bn||(bn=pe());let s=O,t=x;const i=2**M,a=i,r=L(i-1),l=L(M);for(let c=0;c<Nn;c++){let u=Number(n&r);n>>=l,u>nn&&(u-=a,n+=1n);const f=c*nn,g=f,y=f+Math.abs(u)-1,d=c%2!==0,m=u<0;u===0?t=t.add(hn(d,e[g])):s=s.add(hn(m,e[y]))}return{p:s,f:t}};function Ie(n){const e=Kn([Bn.Buffer.from(n,"hex")]);return Pn(e)}function Ae(n,e){const{sigRetrievelRandomness:s,...t}=n,i={...t,blindingRandomness:n.sigRetrievelRandomness},a=Jn.createUnsignedCredentialV1(JSON.stringify(i));let r;try{r=JSON.parse(a)}catch{throw new Error(a)}return{expiry:e,...r}}async function Ce(n,e){const s=Wn(n);return Bn.Buffer.from(await ge(s,e)).toString("hex")}export{we as _,Ae as c,Ie as g,Ce as s};
